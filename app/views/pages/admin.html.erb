<% content_for :title do %> - Admin Panel<% end %>
<%= stylesheet_link_tag "pages/admin" %>

<h2 class="no-bold">Admin Panel</h2>

<% if Rails.env.development? %>
	<div class="dev-tools">
		<h2 class="zero-top zero-bot">Developer Tools</h2>
		You're running Carpe in development, so we'll be providing some tools for you.

		<h3 class="no-bold">Javascript Tests</h3>
		<%= link_to "/teaspoon/default", target: "_blank", class: "default" do %>
			<span>JS Test Results</span>
		<% end %>
		<%= link_to "/coveragejs/default/index.html", target: "_blank", class: "default" do %>
			<span>JS Test Coverage</span>
		<% end %>
		<div class="tip">
			Run <code>bundle exec teaspoon --coverage=default</code> to get this to update.
			<div class="sub-tip">
				Make sure you have the Istanbul NPM package (install with <code>npm install -g istanbul</code> if you don't)
			</div>
		</div>

		<h3 class="no-bold">Ruby on Rails Tests</h3>
		<%= link_to "/html_reports", target: "_blank", class: "default" do %>
			<span>RoR Test Results</span>
		<% end %>
		<%= link_to "/coverage/index.html", target: "_blank", class: "default" do %>
			<span>RoR Test Coverage</span>
		<% end %>
		<br>
		<div class="tip">
			Run <code>bundle exec rake test</code> to get these to update
		</div>
	</div>
<% end %>

<h4>Info</h4>
<a href="/users" class="default"><span>View Users</span></a>
<a href="/sandbox" class="default"><span>Sandbox</span></a>
<br><br>
On Carpe there are: <br>
 <%= Event.count %> events, <%= User.count %> users, and <%= Category.count %> categories. <br>
The average user has: <%= Event.count/User.count %> events and <%= Category.count/User.count %> categories.

<div class="chart-cont">
	<%= line_chart date_chart_fix(@past_month_users, @past, @now), library: {"title":"User Signups in past Month"} %>
	<%= line_chart date_chart_fix(@past_month_events, @past, @now), library: {"title":"Events made in past Month"} %>
	<%= line_chart date_chart_fix(@past_month_events_modified, @past, @now), library: {"title":"Events changed in past Month"} %>
</div>

<h4>Admins</h4>
<% @users = User.where(admin: true) %>
<% @users.each do |user| %>
	<div class="grey-box admin-box">
		<%= link_to(user) do %>
			<div class="avatar" style="float: left">
				<img src="<%= user.user_avatar(100) %>">
			</div>
		<% end %>
		<div class="name"><%= user.name %></div>
	</div>
<% end %>
