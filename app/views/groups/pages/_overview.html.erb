<%= stylesheet_link_tag "activity" %>

<div id="body">
  <main class="content">
    <span class="carpe-color current-header">Current Events</span>
    <% if cannot? :view_details, @group %>
      <span> To see upcoming events, you have to join the group first! </span>
    <% elsif @upcoming_events.empty? %>
      <% if current_user&.in_group? @group %>
        <span> This group has no events, make some! </span>
      <% else %>
        <span> This group doesn't have any publicly visible events going on! </span>
      <% end %>
    <% else %>
      <%= render partial: "shared/event_tile",
                 collection: @upcoming_events,
                 as: :event %>
    <% end %>
  </main>

  <aside id="group-overview-info" class="vertical flex-list sidebar with-horizontal-borders">
    <div>
      <h2>About</h2>
      <p><%= @group.description %></p>
    </div>

    <div>
      <div id="side-member-pane">
        <h2>Members <%= link_to "View More", group_path(@group, view: :members), id:"view-all-link" %></h2>
        <% if cannot? :view_details, @group %>
          <i>You cannot see members unless you are a member of this group</i>
        <% elsif @group.empty? %>
          <span> This group has no members </span>
        <% else %>
          <% @group.members.first(4).each do |member| %>
            <%= link_avatar member %>
          <% end %>
        <% end %>
      </div>
    </div>

    <div>
      <h2>Recent Actions</h2>
      <% if cannot? :view_details, @group %>
        <i>You cannot see recent activities unless you are a member of this group</i>
      <% elsif @activities.empty? %>
        <span> This group has no recent actions </span>
      <% else %>
        <%= render partial: "groups/small_activity_card", collection: @activities, as: :act %>
      <% end %>
    </div>
  </aside>
</div>