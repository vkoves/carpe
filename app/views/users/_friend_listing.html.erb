<h2 class="no-bold">Friends
	<% if current_user and !@profile %>
		<span style="font-size: 18px;">(
			<% mut = current_user.mutual_friends(@user).count %>
			<% if mut > 0 #only link if there are some %>
				<a href="?p=mutual_friends" class="normal">	<%= mut %> Mutual </a>
			<% else %>
				<%= mut %> Mutual
			<% end %>
			)
		</span>
	<% end %>
</h2>
<div id="friend-list">
<% if @all_friends.empty? %>
	<span class="empty-text">
		<% if @profile %>
			It looks awfully empty here... add some friends to fill it up!
		<% else %>
			It looks like <%= @user.name.split(" ")[0] %> doesn't have any friends yet.
		<% end %>
	</span>
<% else %>
	<% for arr in @all_friends %>
		<% friendship = arr[0]; user = arr[1] %>
		<% if @profile %>
			<div class="friend-listing" style="width: 310px">
				<a href="/u/<%= user.id %>">
					<div class="avatar" style="float: left">
						<img src="<%= user.user_avatar(100) %>">
					</div>
				</a>
				<div class="friend-details">
					<span class="friend-name"><%= user.name %></span><br>
					<%= user.friends_count %> Friends <br>
					Friends since: <%= friendship.created_at.strftime("%b. %d, %Y")%> <br>
						<%= link_to friendships_path(:id => friendship.id), :method => :delete, :class => "default red",
						:style => "position: relative; top: 5px;" do %>
							<span>Remove</span>
						<% end %>
				</div>
			</div>
		<% elsif %>
			<div class="friend-listing" style="width: 300px; height: auto;">
				<a href="/u/<%= user.id %>">
					<div class="avatar" style="float: left">
						<img src="<%= user.user_avatar(100) %>">
					</div>
				</a>
				<div class="friend-details" style="margin-top: 7px;">
					<span class="friend-name"><%= user.name %></span><br>
					<% if user == current_user %>
						<% break %>
					<% end %>
					<% mut = current_user.mutual_friends(user).count %>
					<span style="position: relative; top: -3px;"><%= mut %> mutual friends</span>
					<br>					<% status = current_user.friend_status(user) %>
					<% if status == nil #not friends %>
						<%= link_to friendships_path(:friend_id => user), :method => :post, :class => "default green" do %>
							<span>Add Friend</span>
						<% end %>
					<% elsif status == "friend" %>
						<span class="friend-label">Friend</span>
					<% elsif status == "pending" || status == "denied" %>
						<span class="friend-label">Pending...</span>
					<% end %>
				</div>
			</div>
		<% end %>
	<% end %>
<% end%>
</div>
<% if @user == current_user %>
	<%= link_to "/find_friends", :class => "default" do %>
		<span>Find Friends</span>
	<% end %>
<% end %>
